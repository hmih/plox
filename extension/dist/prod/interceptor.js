"use strict";(()=>{var g={SYNC:0,UPDATE:1,RETRY:2};var A=(e,...i)=>{};(function(){let e={Object,Function,Array,JSON,Promise,Symbol,Map,Set,Proxy,Reflect,fetch:window.fetch.bind(window),XMLHttpRequest:window.XMLHttpRequest,document,window,console,Object_defineProperty:Object.defineProperty,Object_getOwnPropertyDescriptor:Object.getOwnPropertyDescriptor,Object_getOwnPropertySymbols:Object.getOwnPropertySymbols,Object_keys:Object.keys,Function_prototype_call:Function.prototype.call,Function_prototype_apply:Function.prototype.apply,Function_prototype_bind:Function.prototype.bind,EventTarget_prototype_addEventListener:EventTarget.prototype.addEventListener,EventTarget_prototype_dispatchEvent:EventTarget.prototype.dispatchEvent,MessagePort_prototype_postMessage:MessagePort.prototype.postMessage,Document_prototype_createElement:Document.prototype.createElement},i=(o,r,...t)=>e.Function_prototype_call.apply(o,[r,...t]),m=(o,r,t)=>e.Function_prototype_apply.apply(o,[r,t]),C=o=>e.JSON.parse(o),v=o=>e.JSON.stringify(o);function l(o,r){let t=e.Object_getOwnPropertyDescriptor(r,"name");t&&e.Object_defineProperty(o,"name",t);let s=e.Object_getOwnPropertyDescriptor(r,"length");s&&e.Object_defineProperty(o,"length",s),e.Object_defineProperty(o,"toString",{value:function(){return this===o?r.toString():i(r.toString,this)},configurable:!0,enumerable:!1,writable:!0})}let R=new e.Map,_=new e.Set,h=[],y=null;function w(o){if(!o||typeof o!="object")return!1;let r=!1,t=o;if(typeof t.screen_name=="string"&&typeof t.name=="string"){let n=t.screen_name.toLowerCase(),c=R.get(n);c?t.name.includes(c)||(t.name=`${t.name} ${c}`,r=!0,A(`Applied flag to ${n}`)):_.has(n)||(_.add(n),y?i(e.MessagePort_prototype_postMessage,y,{type:g.SYNC,handle:n}):h.push(n))}let s=o;for(let n in s)if(Object.prototype.hasOwnProperty.call(s,n)){let c=s[n];c&&typeof c=="object"&&(e.Array.isArray(c)||n==="data"||n==="user"||n==="legacy"||n==="user_results"||n==="result"||n==="core"||n==="instructions"||n==="entries"||n==="content"||n==="itemContent"||n==="tweet_results")&&w(c)&&(r=!0)}return r}function S(o){let r=new e.Proxy(o,{apply:async(t,s,n)=>{let c=n[0],p=typeof c=="string"?c:c instanceof URL?c.href:c.url;if(!(p&&p.includes("/i/api/graphql/")))return e.Reflect.apply(t,e.window,n);let M=await e.Reflect.apply(t,e.window,n),F=T=>new e.Proxy(T,{get(u,b,N){if(b==="json"){let f=u.json,d=async function(){let O=await i(f,u);try{if(w(O))return O}catch{}return O};return l(d,f),d}if(b==="clone"){let f=u.clone,d=function(){return F(i(f,u))};return l(d,f),d}let P=e.Reflect.get(u,b,N);return typeof P=="function"?i(e.Function_prototype_bind,P,u):P}});return F(M)}});return l(r,o),r}let x=S(e.fetch);window.fetch=x;let E=new e.Proxy(e.XMLHttpRequest,{construct(o,r){let t=new o(...r),s=t.open,n=!1;t.open=function(p,a){return(typeof a=="string"?a:a.toString()).includes("/i/api/graphql/")&&(n=!0),m(s,this,arguments)};let c=t.send;return t.send=function(){if(n){let p=t.onreadystatechange;t.onreadystatechange=function(){if(t.readyState===4&&t.status===200)try{let a=C(t.responseText);w(a)&&(e.Object_defineProperty(t,"responseText",{value:v(a),configurable:!0}),e.Object_defineProperty(t,"response",{value:a,configurable:!0}))}catch{}if(p)return m(p,this,arguments)}}return m(c,this,arguments)},t}});l(E,e.XMLHttpRequest),window.XMLHttpRequest=E;let j=new e.Proxy(e.Document_prototype_createElement,{apply:(o,r,t)=>{let s=e.Reflect.apply(o,r,t);if(s&&s.tagName==="IFRAME"&&e.Object_getOwnPropertyDescriptor(e.window.HTMLIFrameElement.prototype,"contentWindow")?.get)try{let c=new MutationObserver(()=>{s.contentWindow&&(s.contentWindow.fetch=S(s.contentWindow.fetch),c.disconnect())});c.observe(document.documentElement,{childList:!0,subtree:!0})}catch{}return s}});l(j,e.Document_prototype_createElement),document.createElement=j;let D=o=>{for(y=o,y.onmessage=r=>{let t=r.data;if(t.type===g.UPDATE){let s=t;R.set(s.handle.toLowerCase(),s.flag)}else if(t.type===g.RETRY){let{handle:s}=t;_.delete(s.toLowerCase())}};h.length>0;){let r=h.shift();r&&i(e.MessagePort_prototype_postMessage,y,{type:g.SYNC,handle:r})}},L=e.Symbol("x-compat-handshake");e.Object_defineProperty(document,L,{get:()=>({connect:o=>{D(o),delete document[L]}}),configurable:!0,enumerable:!1})})();})();
